const fs = require('fs');
const path = require('path');

async function testKnowledge() {
  console.log('ğŸ§ª æ¸¬è©¦çŸ¥è­˜åº«è¼‰å…¥...\n');
  
  const processedDir = path.join(__dirname, '../knowledge/processed');
  
  console.log('ğŸ“‚ æª¢æŸ¥è™•ç†ç›®éŒ„:', processedDir);
  
  if (!fs.existsSync(processedDir)) {
    console.log('âŒ è™•ç†ç›®éŒ„ä¸å­˜åœ¨');
    return;
  }
  
  const files = fs.readdirSync(processedDir).filter(f => f.endsWith('.md'));
  console.log(`ğŸ“„ æ‰¾åˆ° ${files.length} å€‹è™•ç†æª”æ¡ˆ:`, files.map(f => f.substring(0, 30) + '...'));
  
  // å‰µå»ºæ¸¬è©¦çŸ¥è­˜åº«å…§å®¹
  const testKnowledgePath = path.join(processedDir, 'palmistry-basics.md');
  const testContent = `# ç‰æŒæ´¾æ‰‹ç›¸å­¸åŸºç¤

## æ‰‹å‹åˆ†é¡

### æœ¨å‹æ‰‹
- **ç‰¹å¾µ**ï¼šæ‰‹æŒé•·æ–¹å½¢ï¼Œæ‰‹æŒ‡ä¿®é•·çº–ç´°ï¼Œéª¨ç¯€æ˜é¡¯
- **æ€§æ ¼**ï¼šå‰µé€ åŠ›è±å¯Œï¼Œå…·æœ‰è—è¡“å¤©è³¦ï¼Œæ€ç¶­æ´»èºï¼Œæ„Ÿæƒ…ç´°è†©
- **äº‹æ¥­**ï¼šé©åˆè—è¡“ã€è¨­è¨ˆã€æ•™è‚²ã€æ–‡å­¸å‰µä½œç­‰å‰µæ„æ€§å·¥ä½œ
- **è²¡é‹**ï¼šé€šéæ‰è¯å’Œå‰µæ„ç²å¾—è²¡å¯Œï¼Œéœ€è¦è€å¿ƒç©ç´¯

### ç«å‹æ‰‹
- **ç‰¹å¾µ**ï¼šæ‰‹æŒå‘ˆæ¢¯å½¢ï¼Œæ‰‹æŒ‡è¼ƒçŸ­ä½†æœ‰åŠ›ï¼ŒæŒåšè‚‰å¯¦
- **æ€§æ ¼**ï¼šè¡Œå‹•åŠ›å¼·ï¼Œç†±æƒ…ç©æ¥µï¼Œå…·æœ‰é ˜å°èƒ½åŠ›ï¼Œæ±ºç­–æœæ–·
- **äº‹æ¥­**ï¼šé©åˆç®¡ç†ã€éŠ·å”®ã€å‰µæ¥­ã€é«”è‚²ç­‰éœ€è¦è¡Œå‹•åŠ›çš„å·¥ä½œ
- **è²¡é‹**ï¼šè²¡é‹æ—ºç››ï¼Œå–„æ–¼æŠŠæ¡æ©Ÿæœƒï¼Œå®¹æ˜“æˆåŠŸ

### åœŸå‹æ‰‹
- **ç‰¹å¾µ**ï¼šæ‰‹æŒæ–¹å½¢åšå¯¦ï¼Œæ‰‹æŒ‡ç²—å£¯ï¼Œè‚‰è³ªè±æ»¿
- **æ€§æ ¼**ï¼šå‹™å¯¦ç©©é‡ï¼Œè¸å¯¦å¯é ï¼ŒåŸ·è¡ŒåŠ›å¼·ï¼Œæ³¨é‡å®‰å…¨
- **äº‹æ¥­**ï¼šé©åˆå»ºç¯‰ã€è¾²æ¥­ã€è£½é€ æ¥­ã€é‡‘èç­‰ç©©å®šæ€§å·¥ä½œ
- **è²¡é‹**ï¼šè²¡é‹ç©©å®šï¼Œå–„æ–¼ç†è²¡ï¼Œç©å°‘æˆå¤š

### é‡‘å‹æ‰‹
- **ç‰¹å¾µ**ï¼šæ‰‹æŒæ–¹å½¢ï¼Œæ‰‹æŒ‡é•·åº¦é©ä¸­ï¼ŒæŒ‡ç”²æ•´é½Š
- **æ€§æ ¼**ï¼šç†æ€§å†·éœï¼Œé‚è¼¯æ€ç¶­å¼·ï¼Œæ³¨é‡ç´°ç¯€ï¼Œæœ‰æ¢ç†
- **äº‹æ¥­**ï¼šé©åˆç§‘æŠ€ã€æ³•å¾‹ã€æœƒè¨ˆã€é†«ç™‚ç­‰å°ˆæ¥­æ€§å·¥ä½œ
- **è²¡é‹**ï¼šé€šéå°ˆæ¥­æŠ€èƒ½ç²å¾—ç©©å®šæ”¶å…¥

### æ°´å‹æ‰‹
- **ç‰¹å¾µ**ï¼šæ‰‹æŒæ©¢åœ“å½¢ï¼Œæ‰‹æŒ‡æŸ”è»Ÿéˆæ´»ï¼Œçš®è†šç´°è†©
- **æ€§æ ¼**ï¼šæ„Ÿæ€§ç›´è¦ºï¼Œé©æ‡‰åŠ›å¼·ï¼Œå–„æ–¼æºé€šï¼Œå¯Œæœ‰åŒæƒ…å¿ƒ
- **äº‹æ¥­**ï¼šé©åˆåª’é«”ã€æœå‹™æ¥­ã€å¿ƒç†è«®è©¢ã€å¤–äº¤ç­‰äººéš›æ€§å·¥ä½œ
- **è²¡é‹**ï¼šè²¡é‹å¤šè®Šï¼Œéœ€è¦å­¸æœƒç†è²¡è¦åŠƒ

## ä¸»è¦æŒç´‹ç·šæ¢

### ç”Ÿå‘½ç·šï¼ˆåœ°ç´‹ï¼‰
- **ä½ç½®**ï¼šèµ·æ–¼é£ŸæŒ‡èˆ‡æ‹‡æŒ‡ä¹‹é–“ï¼Œåœç¹æ‹‡æŒ‡æ ¹éƒ¨å½¢æˆå¼§ç·š
- **æ„ç¾©**ï¼šä»£è¡¨å¥åº·ç‹€æ³ã€ç”Ÿå‘½åŠ›å¼·å¼±ã€é‡å¤§ç”Ÿæ´»è®ŠåŒ–
- **åˆ†æè¦é»**ï¼š
  - ç·šæ¢æ¸…æ™°æ·±é•·ï¼šèº«é«”å¥åº·ï¼Œç”Ÿå‘½åŠ›æ—ºç››
  - ç·šæ¢æ·ºçŸ­ï¼šé«”è³ªè¼ƒå¼±ï¼Œéœ€è¦æ³¨æ„ä¿é¤Š
  - æœ‰å³¶ç´‹ï¼šè©²æ™‚æœŸå¥åº·éœ€è¦æ³¨æ„
  - æœ‰æ–·è£‚ï¼šç”Ÿæ´»ä¸­å¯èƒ½æœ‰é‡å¤§è®ŠåŒ–

### æ™ºæ…§ç·šï¼ˆäººç´‹ï¼‰
- **ä½ç½®**ï¼šæ©«å‘ç©¿éæ‰‹æŒä¸­éƒ¨ï¼Œé€šå¸¸èˆ‡ç”Ÿå‘½ç·šå…±åŒèµ·é»
- **æ„ç¾©**ï¼šä»£è¡¨æ€ç¶­æ–¹å¼ã€æ™ºåŠ›æ°´å¹³ã€å­¸ç¿’èƒ½åŠ›ã€æ±ºç­–é¢¨æ ¼
- **åˆ†æè¦é»**ï¼š
  - ç·šæ¢ç›´ï¼šç†æ€§æ€ç¶­ï¼Œé‚è¼¯æ€§å¼·
  - ç·šæ¢å½æ›²ï¼šæ„Ÿæ€§æ€ç¶­ï¼Œå‰µæ„è±å¯Œ
  - ç·šæ¢é•·ï¼šæ€è€ƒæ·±å…¥ï¼Œåˆ†æèƒ½åŠ›å¼·
  - ç·šæ¢çŸ­ï¼šæ€ç¶­æ•æ·ï¼Œæ±ºç­–å¿«é€Ÿ

### æ„Ÿæƒ…ç·šï¼ˆå¤©ç´‹ï¼‰
- **ä½ç½®**ï¼šæ‰‹æŒä¸Šæ–¹çš„æ©«ç·šï¼Œå¾å°æŒ‡å´å‘é£ŸæŒ‡æ–¹å‘
- **æ„ç¾©**ï¼šä»£è¡¨æƒ…æ„Ÿè¡¨é”æ–¹å¼ã€äººéš›é—œä¿‚ã€æ„›æƒ…é‹å‹¢
- **åˆ†æè¦é»**ï¼š
  - ç·šæ¢æ·±é•·ï¼šæ„Ÿæƒ…è±å¯Œï¼Œå°ˆä¸€æŒä¹…
  - ç·šæ¢æ·ºçŸ­ï¼šç†æ€§å¤§æ–¼æ„Ÿæ€§
  - æœ‰åˆ†å²”ï¼šæ„Ÿæƒ…è¤‡é›œï¼Œå¯èƒ½æœ‰å¤šæ®µæˆ€æƒ…
  - æœ‰å³¶ç´‹ï¼šæ„Ÿæƒ…è·¯ä¸Šå¯èƒ½æœ‰å›°æ“¾

## çµ„åˆåˆ¤æ–·åŸå‰‡

### åŸºæœ¬åŸå‰‡
1. **æ‰‹å‹æ±ºå®šåŸºæœ¬æ€§æ ¼æ¡†æ¶**ï¼šå…ˆçœ‹æ•´é«”æ‰‹å‹åˆ†é¡
2. **ä¸»ç·šåæ˜ äººç”Ÿé‡é»é ˜åŸŸ**ï¼šç”Ÿå‘½ã€æ™ºæ…§ã€æ„Ÿæƒ…ä¸‰ç·š
3. **å‰¯ç·šé¡¯ç¤ºç´°ç¯€ç‰¹å¾µ**ï¼šäº‹æ¥­ç·šã€è²¡é‹ç·šç­‰
4. **ç‰¹æ®Šè¨˜è™ŸæŒ‡ç¤ºé—œéµæ™‚æœŸ**ï¼šæ˜Ÿç´‹ã€ä¸‰è§’ç´‹ã€å³¶ç´‹ç­‰
5. **ç¶œåˆåˆ†æå¾—å‡ºçµè«–**ï¼šä¸å¯å–®ç·šè«–æ–·

### çµ„åˆå¯¦ä¾‹
- **æœ¨å‹æ‰‹ + æ™ºæ…§ç·šå½æ›²**ï¼šè—è¡“å‰µä½œå¤©è³¦
- **ç«å‹æ‰‹ + äº‹æ¥­ç·šæ¸…æ™°**ï¼šé ˜å°ç®¡ç†èƒ½åŠ›
- **åœŸå‹æ‰‹ + è²¡é‹ç·šæ·±é•·**ï¼šç†è²¡æŠ•è³‡å¤©è³¦
- **é‡‘å‹æ‰‹ + æ™ºæ…§ç·šç›´é•·**ï¼šå°ˆæ¥­æŠ€è¡“èƒ½åŠ›
- **æ°´å‹æ‰‹ + æ„Ÿæƒ…ç·šè±å¯Œ**ï¼šäººéš›äº¤å¾€å¤©è³¦

## åˆ†ææ­¥é©Ÿ

1. **è§€å¯Ÿæ‰‹å‹**ï¼šç¢ºå®šåŸºæœ¬æ€§æ ¼é¡å‹
2. **åˆ†æä¸‰å¤§ä¸»ç·š**ï¼šäº†è§£æ ¸å¿ƒç‰¹è³ª
3. **æª¢æŸ¥å‰¯ç·šå’Œç‰¹æ®Šè¨˜è™Ÿ**ï¼šè£œå……ç´°ç¯€ä¿¡æ¯
4. **è€ƒæ…®ç·šæ¢çµ„åˆ**ï¼šé€²è¡Œç¶œåˆåˆ¤æ–·
5. **æä¾›å»ºè­°**ï¼šåŸºæ–¼åˆ†æçµ¦å‡ºäººç”ŸæŒ‡å°

æ³¨ï¼šæ‰‹ç›¸åˆ†ææ‡‰ä½œç‚ºè‡ªæˆ‘èªçŸ¥å’Œäººç”Ÿè¦åŠƒçš„åƒè€ƒå·¥å…·ï¼Œè€Œéçµ•å°é æ¸¬ã€‚`;

  fs.writeFileSync(testKnowledgePath, testContent, 'utf8');
  console.log('âœ… å·²å‰µå»ºæ‰‹ç›¸å­¸åŸºç¤çŸ¥è­˜åº«');
  
  // æ¸¬è©¦è®€å–
  const content = fs.readFileSync(testKnowledgePath, 'utf8');
  console.log(`ğŸ“ çŸ¥è­˜åº«å…§å®¹é•·åº¦: ${content.length} å­—ç¬¦`);
  console.log('ğŸ“ å…§å®¹é è¦½:', content.substring(0, 100) + '...');
  
  // æª¢æŸ¥æ‰€æœ‰æª”æ¡ˆ
  const allFiles = fs.readdirSync(processedDir).filter(f => f.endsWith('.md'));
  let totalChars = 0;
  
  console.log('\nğŸ“Š çŸ¥è­˜åº«çµ±è¨ˆ:');
  for (const file of allFiles) {
    const filePath = path.join(processedDir, file);
    const fileContent = fs.readFileSync(filePath, 'utf8');
    totalChars += fileContent.length;
    console.log(`ğŸ“„ ${file}: ${fileContent.length} å­—ç¬¦`);
  }
  
  console.log(`\nğŸ“ˆ ç¸½è¨ˆ: ${allFiles.length} å€‹æª”æ¡ˆ, ${totalChars} å­—ç¬¦`);
  console.log('\nğŸ‰ çŸ¥è­˜åº«æº–å‚™å®Œæˆï¼ç¾åœ¨å¯ä»¥åœ¨æ‡‰ç”¨ä¸­æ¸¬è©¦äº†');
  console.log('ğŸŒ æœ¬åœ°æ¸¬è©¦åœ°å€: http://localhost:3000');
}

testKnowledge();